import subprocess
import json

SCENARIOS = {
    "view_balance": ["1", "4"],
    "credit_100": ["2", "100", "1", "4"],
    "debit_50": ["3", "50", "1", "4"],
    "debit_too_much": ["3", "2000", "1", "4"],
    "debit_0": ["3", "0", "1", "4"],
    "debit_negative": ["3", "-100", "1", "4"],
    "credit_0": ["2", "0", "1", "4"],
    "credit_negative": ["2", "-100", "1", "4"],
    "credit_too_much": ["2", "2000", "1", "4"],
    "credit_character": ["2", "abc", "1", "4"],
    "credit_character_negative": ["2", "abc-100", "1", "4"],
    "credit_character_too_much": ["2", "abc2000", "1", "4"],
    "credit_float": ["2", "100.50", "1", "4"],
    "credit_float_negative": ["2", "-100.50", "1", "4"],
    "credit_float_too_much": ["2", "2000.50", "1", "4"],
    "credit_float_char": ["2", "abc.50", "1", "4"],
    "credit_float_char_negative": ["2", "abc.-100", "1", "4"],
    "credit_float_char_too_much": ["2", "abc.2000", "1", "4"],
    "credit_overflow": ["2", "100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000", "1", "4"],
    "credit_float_overflow": ["2", "10000000000000000000", "1", "4"],
    "exit": ["4"]
}

def run_cobol(inputs):
    process = subprocess.Popen(
        ["./accountsystem"],
        stdin=subprocess.PIPE,
        stdout=subprocess.PIPE,
        stderr=subprocess.PIPE,
        text=True
    )
    stdout, _ = process.communicate("\n".join(inputs))
    return stdout

def main():
    golden_master = {}
    for name, inputs in SCENARIOS.items():
        output = run_cobol(inputs)
        golden_master[name] = {
            "inputs": inputs,
            "output": output
        }
    with open("golden_master.json", "w") as f:
        json.dump(golden_master, f, indent=2)

if __name__ == "__main__":
    main()
